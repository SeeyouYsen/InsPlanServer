# InsPlan å¾®æœåŠ¡æ¶æ„

## é¡¹ç›®æ¦‚è§ˆ

InsPlan æ˜¯ä¸€ä¸ªå®Œæ•´çš„ä¿é™©è®¡åˆ’ç®¡ç†å¹³å°ï¼Œé‡‡ç”¨å¾®æœåŠ¡æ¶æ„è®¾è®¡ã€‚é¡¹ç›®å±•ç¤ºäº†ä»å•ä½“åº”ç”¨åˆ°å¾®æœåŠ¡çš„æˆåŠŸè¿ç§»ï¼ŒåŒ…å«äº†å®Œæ•´çš„ä¸šåŠ¡åŠŸèƒ½ã€åŸºç¡€è®¾æ–½å’Œè¿ç»´ä½“ç³»ã€‚

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ ¸å¿ƒæœåŠ¡
- **API Gateway** (8080) - ç»Ÿä¸€å…¥å£ã€è·¯ç”±ã€è®¤è¯ã€é™æµ
- **User Service** (8001) - ç”¨æˆ·ç®¡ç†ã€è®¤è¯æˆæƒ
- **Plan Service** (8002) - ä¿é™©è®¡åˆ’ç®¡ç†
- **Order Service** (8083) - è®¢å•å¤„ç†å’Œç®¡ç†  
- **Payment Service** (8003) - æ”¯ä»˜å¤„ç†å’Œç½‘å…³é›†æˆ
- **Notification Service** (8004) - é€šçŸ¥å‘é€å’Œæ¨¡æ¿ç®¡ç†

### åŸºç¡€è®¾æ–½
- **PostgreSQL** - æ•°æ®æŒä¹…åŒ–ï¼ˆæ¯æœåŠ¡ç‹¬ç«‹æ•°æ®åº“ï¼‰
- **Redis** - ç¼“å­˜å’Œä¼šè¯å­˜å‚¨
- **Consul** - æœåŠ¡æ³¨å†Œä¸å‘ç°
- **Prometheus + Grafana** - ç›‘æ§å’Œå¯è§†åŒ–
- **ELK Stack** - æ—¥å¿—èšåˆå’Œåˆ†æ

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚
```bash
# å®‰è£…ä¾èµ–
brew install docker docker-compose
brew install jq curl
```

### å¯åŠ¨æœåŠ¡
```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd InsPlan/microservices-migration

# æ„å»ºå’Œå¯åŠ¨æ‰€æœ‰æœåŠ¡
./deploy.sh

# éªŒè¯æœåŠ¡çŠ¶æ€
./test-apis.sh
```

### æœåŠ¡è®¿é—®
- API Gateway: http://localhost:8080
- Prometheus: http://localhost:9090  
- Grafana: http://localhost:3000 (admin/admin)
- Kibana: http://localhost:5601

## ğŸ“ é¡¹ç›®ç»“æ„

## ç›®å½•ç»“æ„

```
microservices-migration/
â”œâ”€â”€ api-gateway/           # API ç½‘å…³æœåŠ¡
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ user-service/      # ç”¨æˆ·ç®¡ç†æœåŠ¡
â”‚   â”œâ”€â”€ plan-service/      # ä¿é™©è®¡åˆ’æœåŠ¡
â”‚   â”œâ”€â”€ order-service/     # è®¢å•ç®¡ç†æœåŠ¡
â”‚   â”œâ”€â”€ payment-service/   # æ”¯ä»˜å¤„ç†æœåŠ¡
â”‚   â”œâ”€â”€ notification-service/ # é€šçŸ¥æœåŠ¡
â”‚   â””â”€â”€ shared/           # å…±äº«ç»„ä»¶
â”œâ”€â”€ infrastructure/       # åŸºç¡€è®¾æ–½é…ç½®
â”‚   â”œâ”€â”€ kubernetes/       # K8s éƒ¨ç½²æ–‡ä»¶
â”‚   â””â”€â”€ monitoring/       # ç›‘æ§é…ç½®
â”œâ”€â”€ docker-compose.yml    # å®¹å™¨ç¼–æ’
â”œâ”€â”€ deploy.sh            # éƒ¨ç½²è„šæœ¬
â””â”€â”€ test-apis.sh         # API æµ‹è¯•è„šæœ¬
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **åç«¯**: Swift + Vapor 4.x
- **æ•°æ®åº“**: PostgreSQL + Fluent ORM
- **ç¼“å­˜**: Redis
- **æœåŠ¡å‘ç°**: Consul
- **ç›‘æ§**: Prometheus + Grafana
- **æ—¥å¿—**: ELK Stack
- **å®¹å™¨åŒ–**: Docker + Docker Compose
- **ç¼–æ’**: Kubernetes

## ğŸ“‹ åŠŸèƒ½ç‰¹æ€§

### âœ… å·²å®ŒæˆåŠŸèƒ½

#### ç”¨æˆ·ç®¡ç†
- ç”¨æˆ·æ³¨å†Œå’Œç™»å½•
- JWT ä»¤ç‰Œè®¤è¯
- ç”¨æˆ·é…ç½®æ–‡ä»¶ç®¡ç†
- å¯†ç åŠ å¯†å’ŒéªŒè¯

#### ä¿é™©è®¡åˆ’ç®¡ç†
- ä¿é™©äº§å“ CRUD æ“ä½œ
- åˆ†ç±»å’Œç‰¹æ€§ç®¡ç†
- è¯„ä»·å’Œè¯„åˆ†ç³»ç»Ÿ
- ä»·æ ¼å’Œè¦†ç›–èŒƒå›´é…ç½®

#### è®¢å•ç®¡ç†
- è®¢å•åˆ›å»ºå’ŒçŠ¶æ€è·Ÿè¸ª
- ç”³è¯·äººå’Œå—ç›Šäººä¿¡æ¯ç®¡ç†
- è®¢å•ç”Ÿå‘½å‘¨æœŸç®¡ç†
- ä¸šåŠ¡è§„åˆ™éªŒè¯

#### æ”¯ä»˜å¤„ç†
- å¤šæ”¯ä»˜æ–¹å¼æ”¯æŒï¼ˆæ”¯ä»˜å®ã€å¾®ä¿¡æ”¯ä»˜ï¼‰
- æ”¯ä»˜çŠ¶æ€ç®¡ç†
- é€€æ¬¾å¤„ç†
- æ”¯ä»˜ç½‘å…³é›†æˆæ¡†æ¶

#### é€šçŸ¥ç³»ç»Ÿ
- å¤šæ¸ é“é€šçŸ¥ï¼ˆé‚®ä»¶ã€çŸ­ä¿¡ã€æ¨é€ï¼‰
- é€šçŸ¥æ¨¡æ¿ç³»ç»Ÿ
- æ‰¹é‡é€šçŸ¥å‘é€
- å‘é€çŠ¶æ€è·Ÿè¸ª

#### API ç½‘å…³
- è¯·æ±‚è·¯ç”±å’Œè´Ÿè½½å‡è¡¡
- ç»Ÿä¸€è®¤è¯å’Œæˆæƒ
- è¯·æ±‚é™æµå’Œç†”æ–­
- CORS é…ç½®

#### åŸºç¡€è®¾æ–½
- Docker å®¹å™¨åŒ–éƒ¨ç½²
- Kubernetes ç¼–æ’é…ç½®
- æœåŠ¡æ³¨å†Œä¸å‘ç°
- ç›‘æ§å’Œæ—¥å¿—èšåˆ
- å¥åº·æ£€æŸ¥å’Œæ•…éšœæ¢å¤

## ğŸ”§ å¼€å‘æŒ‡å—

### æœ¬åœ°å¼€å‘ç¯å¢ƒ

1. **å¯åŠ¨åŸºç¡€è®¾æ–½**
```bash
# å¯åŠ¨æ•°æ®åº“å’Œç¼“å­˜
docker-compose up -d postgres redis consul
```

2. **è¿è¡ŒæœåŠ¡**
```bash
# è¿›å…¥æœåŠ¡ç›®å½•
cd services/user-service
swift run

# æˆ–ä½¿ç”¨ Docker
docker-compose up user-service
```

3. **æµ‹è¯• API**
```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
./test-apis.sh

# æµ‹è¯•å•ä¸ªæœåŠ¡
curl http://localhost:8001/health
```

### æ·»åŠ æ–°æœåŠ¡

1. åœ¨ `services/` ç›®å½•ä¸‹åˆ›å»ºæ–°æœåŠ¡
2. ä½¿ç”¨ç»Ÿä¸€çš„é¡¹ç›®ç»“æ„ï¼ˆControllersã€Modelsã€DTOsã€Migrationsï¼‰
3. æ›´æ–° `docker-compose.yml` æ·»åŠ æœåŠ¡é…ç½®
4. åœ¨ `deploy.sh` ä¸­æ·»åŠ æ„å»ºå’Œå¥åº·æ£€æŸ¥
5. åœ¨æµ‹è¯•è„šæœ¬ä¸­æ·»åŠ  API æµ‹è¯•

## ğŸ” ç›‘æ§å’Œè¿ç»´

### å¥åº·æ£€æŸ¥
```bash
# æ£€æŸ¥æ‰€æœ‰æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æœåŠ¡æ—¥å¿—
docker-compose logs [service-name]

# å¥åº·æ£€æŸ¥ç«¯ç‚¹
curl http://localhost:8001/health  # ç”¨æˆ·æœåŠ¡
curl http://localhost:8002/health  # è®¡åˆ’æœåŠ¡
# ...
```

### ç›‘æ§é¢æ¿
- **Prometheus**: http://localhost:9090 - æŒ‡æ ‡æ”¶é›†
- **Grafana**: http://localhost:3000 - å¯è§†åŒ–é¢æ¿
- **Kibana**: http://localhost:5601 - æ—¥å¿—åˆ†æ

### æ‰©å±•æœåŠ¡
```bash
# æ‰©å±•ç‰¹å®šæœåŠ¡å®ä¾‹
docker-compose up --scale user-service=3

# Kubernetes è‡ªåŠ¨æ‰©å±•
kubectl autoscale deployment user-service --cpu-percent=50 --min=1 --max=10
```

## ğŸ§ª æµ‹è¯•

### API æµ‹è¯•
```bash
# è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶
./test-apis.sh

# æ‰‹åŠ¨æµ‹è¯•ç¤ºä¾‹
# ç”¨æˆ·æ³¨å†Œ
curl -X POST http://localhost:8001/api/users/register \
  -H "Content-Type: application/json" \
  -d '{"username":"test","email":"test@example.com","password":"password123"}'

# åˆ›å»ºä¿é™©è®¡åˆ’
curl -X POST http://localhost:8002/api/plans \
  -H "Content-Type: application/json" \
  -d '{"name":"å¥åº·ä¿é™©","premium":1000,"coverage":100000}'
```

### æ€§èƒ½æµ‹è¯•
```bash
# ä½¿ç”¨ Apache Bench è¿›è¡Œè´Ÿè½½æµ‹è¯•
ab -n 1000 -c 10 http://localhost:8080/api/plans

# ä½¿ç”¨ wrk è¿›è¡Œå‹åŠ›æµ‹è¯•
wrk -t12 -c400 -d30s http://localhost:8080/api/users
```

## ğŸš€ éƒ¨ç½²

### Docker Compose éƒ¨ç½²
```bash
# ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d

# æ»šåŠ¨æ›´æ–°
docker-compose up -d --no-deps user-service
```

### Kubernetes éƒ¨ç½²
```bash
# éƒ¨ç½²åˆ° Kubernetes
kubectl apply -f infrastructure/kubernetes/

# æ£€æŸ¥éƒ¨ç½²çŠ¶æ€
kubectl get pods -l app=insplan

# æŸ¥çœ‹æœåŠ¡
kubectl get services
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

### ç³»ç»Ÿå®¹é‡
- **å¹¶å‘ç”¨æˆ·**: 1000+
- **è¯·æ±‚å“åº”æ—¶é—´**: <200ms (P95)
- **ç³»ç»Ÿå¯ç”¨æ€§**: 99.9%
- **æ•°æ®ä¸€è‡´æ€§**: æœ€ç»ˆä¸€è‡´æ€§

### æ‰©å±•æ€§
- **æ°´å¹³æ‰©å±•**: æ”¯æŒæœåŠ¡å®ä¾‹åŠ¨æ€æ‰©ç¼©å®¹
- **æ•°æ®åº“**: æ”¯æŒè¯»å†™åˆ†ç¦»å’Œåˆ†ç‰‡
- **ç¼“å­˜**: å¤šçº§ç¼“å­˜ç­–ç•¥
- **CDN**: é™æ€èµ„æºåˆ†å‘

## ğŸ”’ å®‰å…¨æ€§

### è®¤è¯å’Œæˆæƒ
- JWT ä»¤ç‰Œè®¤è¯
- åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶
- API å¯†é’¥ç®¡ç†
- OAuth2 é›†æˆå‡†å¤‡

### ç½‘ç»œå®‰å…¨
- HTTPS ç»ˆç«¯åŠ å¯†
- æœåŠ¡é—´ TLS é€šä¿¡
- ç½‘ç»œéš”ç¦»å’Œé˜²ç«å¢™
- DDoS é˜²æŠ¤

### æ•°æ®å®‰å…¨
- æ•æ„Ÿæ•°æ®åŠ å¯†
- æ•°æ®åº“è®¿é—®æ§åˆ¶
- å®¡è®¡æ—¥å¿—è®°å½•
- æ•°æ®å¤‡ä»½å’Œæ¢å¤

## ğŸš§ åç»­è§„åˆ’

### çŸ­æœŸç›®æ ‡
- [ ] å®Œå–„å•å…ƒæµ‹è¯•è¦†ç›–ç‡
- [ ] æ·»åŠ  OpenAPI æ–‡æ¡£ç”Ÿæˆ
- [ ] å®ç°é…ç½®ä¸­å¿ƒé›†æˆ
- [ ] ä¼˜åŒ–å®¹å™¨é•œåƒå¤§å°

### ä¸­æœŸç›®æ ‡
- [ ] å®ç°äº‹ä»¶é©±åŠ¨æ¶æ„
- [ ] æ·»åŠ åˆ†å¸ƒå¼è¿½è¸ª (Jaeger)
- [ ] å®ç°æœåŠ¡ç½‘æ ¼ (Istio)
- [ ] å¤šç¯å¢ƒéƒ¨ç½²è‡ªåŠ¨åŒ–

### é•¿æœŸç›®æ ‡
- [ ] å®ç°å¤šç§Ÿæˆ·æ¶æ„
- [ ] æ·»åŠ æœºå™¨å­¦ä¹ æ¨è
- [ ] å®ç°å®æ—¶æ•°æ®å¤„ç†
- [ ] äº‘åŸç”Ÿæ¶æ„å‡çº§

## ğŸ“– æ–‡æ¡£

- [æ¶æ„è®¾è®¡æ–‡æ¡£](architecture-design.md)
- [é¡¹ç›®å®ŒæˆæŠ¥å‘Š](PROJECT_COMPLETION_REPORT.md)
- [API æ–‡æ¡£](https://api.insplan.com/docs) (å¾…ç”Ÿæˆ)
- [éƒ¨ç½²æŒ‡å—](deploy.sh)

## ğŸ¤ è´¡çŒ®

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æ‰“å¼€ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ“ è”ç³»

- é¡¹ç›®ç»´æŠ¤è€…: [Your Name]
- é‚®ç®±: [your.email@example.com]
- é¡¹ç›®é“¾æ¥: [https://github.com/your-username/insplan](https://github.com/your-username/insplan)

---

## ğŸ‰ é¡¹ç›®äº®ç‚¹

âœ¨ **å®Œæ•´çš„å¾®æœåŠ¡æ¶æ„** - ä»å•ä½“åº”ç”¨æˆåŠŸè¿ç§»åˆ°å¾®æœåŠ¡æ¶æ„
ğŸ—ï¸ **ç°ä»£åŒ–æŠ€æœ¯æ ˆ** - Swift + Vapor + Docker + Kubernetes
ğŸ“Š **å®Œå–„çš„ç›‘æ§ä½“ç³»** - Prometheus + Grafana + ELK Stack
ğŸ”’ **ä¼ä¸šçº§å®‰å…¨æ€§** - JWT è®¤è¯ + HTTPS + æ•°æ®åŠ å¯†
ğŸš€ **é«˜å¯ç”¨æ€§è®¾è®¡** - æœåŠ¡å‘ç° + å¥åº·æ£€æŸ¥ + è‡ªåŠ¨æ¢å¤
ğŸ“ˆ **å¯æ‰©å±•æ¶æ„** - æ°´å¹³æ‰©å±• + è´Ÿè½½å‡è¡¡ + ç¼“å­˜ç­–ç•¥
